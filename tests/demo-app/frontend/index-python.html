<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Todo App - Log Collector Demo</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 600px;
            margin: 0 auto;
        }

        .card {
            background: white;
            border-radius: 12px;
            padding: 24px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
        }

        h1 {
            color: #333;
            margin-bottom: 20px;
            text-align: center;
        }

        .login-form, .todo-app {
            display: none;
        }

        .login-form.active, .todo-app.active {
            display: block;
        }

        input[type="text"], input[type="password"] {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 14px;
            margin-bottom: 12px;
            transition: border-color 0.3s;
        }

        input:focus {
            outline: none;
            border-color: #667eea;
        }

        button {
            background: #667eea;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: background 0.3s;
        }

        button:hover {
            background: #5568d3;
        }

        button:disabled {
            background: #ccc;
            cursor: not-allowed;
        }

        .btn-secondary {
            background: #6c757d;
        }

        .btn-secondary:hover {
            background: #5a6268;
        }

        .btn-danger {
            background: #dc3545;
        }

        .btn-danger:hover {
            background: #c82333;
        }

        .btn-small {
            padding: 6px 12px;
            font-size: 12px;
        }

        .todo-input-group {
            display: flex;
            gap: 8px;
            margin-bottom: 20px;
        }

        .todo-input-group input {
            flex: 1;
            margin-bottom: 0;
        }

        .todo-list {
            list-style: none;
        }

        .todo-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            margin-bottom: 8px;
            transition: all 0.3s;
        }

        .todo-item:hover {
            border-color: #667eea;
            box-shadow: 0 2px 8px rgba(102, 126, 234, 0.1);
        }

        .todo-item.completed {
            opacity: 0.6;
        }

        .todo-item.completed .todo-text {
            text-decoration: line-through;
        }

        .todo-checkbox {
            width: 20px;
            height: 20px;
            cursor: pointer;
        }

        .todo-text {
            flex: 1;
            color: #333;
        }

        .test-buttons {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
            margin-top: 20px;
        }

        .user-info {
            text-align: center;
            padding: 12px;
            background: #f8f9fa;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .user-info strong {
            color: #667eea;
        }

        .status {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: #28a745;
            color: white;
            padding: 12px 20px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            display: none;
        }

        .status.show {
            display: block;
            animation: slideIn 0.3s ease;
        }

        @keyframes slideIn {
            from {
                transform: translateX(400px);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        .error {
            color: #dc3545;
            font-size: 14px;
            margin-top: 8px;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Î°úÍ∑∏Ïù∏ Ìèº -->
        <div class="login-form active">
            <div class="card">
                <h1>üîê Î°úÍ∑∏Ïù∏</h1>
                <form id="loginForm">
                    <input type="text" id="username" placeholder="Username (demo)" required>
                    <input type="password" id="password" placeholder="Password (demo123)" required>
                    <button type="submit">Î°úÍ∑∏Ïù∏</button>
                    <div id="loginError" class="error"></div>
                </form>
            </div>
        </div>

        <!-- Todo Ïï± -->
        <div class="todo-app">
            <div class="card">
                <div class="user-info">
                    <span>üë§ <strong id="currentUser"></strong></span>
                    <button class="btn-small btn-secondary" onclick="logout()" style="margin-left: 12px;">Î°úÍ∑∏ÏïÑÏõÉ</button>
                </div>

                <h1>üìù Todo List</h1>

                <div class="todo-input-group">
                    <input type="text" id="todoInput" placeholder="ÏÉà Ìï† Ïùº ÏûÖÎ†•...">
                    <button onclick="addTodo()">Ï∂îÍ∞Ä</button>
                </div>

                <ul class="todo-list" id="todoList"></ul>

                <div class="test-buttons">
                    <button class="btn-small" onclick="runFullTest()" style="background: #28a745;">üöÄ Ï†ÑÏ≤¥ Í∏∞Îä• ÌÖåÏä§Ìä∏</button>
                    <button class="btn-danger btn-small" onclick="testError()">‚ùå ÏóêÎü¨ ÌÖåÏä§Ìä∏</button>
                    <button class="btn-secondary btn-small" onclick="testSlowApi()">‚è±Ô∏è ÌÉÄÏù¥Î®∏ ÌÖåÏä§Ìä∏</button>
                    <button class="btn-secondary btn-small" onclick="testBatchLogs()">üì¶ Î∞∞Ïπò Î°úÍ∑∏ ÌÖåÏä§Ìä∏</button>
                    <button class="btn-secondary btn-small" onclick="testTracing()">üîç Î∂ÑÏÇ∞ Ï∂îÏ†Å ÌÖåÏä§Ìä∏</button>
                    <button class="btn-secondary btn-small" onclick="testAllLogLevels()">üìä Î°úÍ∑∏ Î†àÎ≤® ÌÖåÏä§Ìä∏</button>
                </div>
            </div>
        </div>
    </div>

    <div class="status" id="status"></div>

    <script type="module">
        // Î∏åÎùºÏö∞Ï†ÄÏóêÏÑú log-client-async ÏÇ¨Ïö©
        // Ïã§Ï†úÎ°úÎäî Î≤àÎì§Îü¨Î•º ÌÜµÌï¥ importÌï¥Ïïº ÌïòÏßÄÎßå, Îç∞Î™®Î•º ÏúÑÌï¥ CDNÏù¥ÎÇò Î°úÏª¨ ÎπåÎìú ÏÇ¨Ïö©
        // Ïó¨Í∏∞ÏÑúÎäî Í∞ÑÎã®Ìûà fetch APIÎ°ú ÎåÄÏ≤¥

        const API_URL = 'http://localhost:3002/api';
        let currentUser = null;
        let currentTraceId = null;

        // ============================================================================
        // Î°úÍ±∞ ÏÉùÏÑ± (enableGlobalErrorHandler ÏòµÏÖò Ìè¨Ìï®)
        // ============================================================================
        class SimpleLogger {
            constructor(options = {}) {
                this.service = options.service || 'demo-todo-frontend-python';
                this.environment = options.environment || 'development';
                this.logType = options.logType || 'FRONTEND';
                this.enableGlobalErrorHandler = options.enableGlobalErrorHandler !== undefined
                    ? options.enableGlobalErrorHandler
                    : false;

                // Í∏ÄÎ°úÎ≤å ÏóêÎü¨ Ìï∏Îì§Îü¨ ÏÑ§Ï†ï
                if (this.enableGlobalErrorHandler) {
                    this._setupGlobalErrorHandler();
                }
            }

            _setupGlobalErrorHandler() {
                window.addEventListener('error', (event) => {
                    this.error('Uncaught error', {
                        message: event.message,
                        source: event.filename,
                        line: event.lineno,
                        column: event.colno,
                        stack: event.error ? event.error.stack : 'N/A',
                        error_type: 'UncaughtError'
                    });
                });

                window.addEventListener('unhandledrejection', (event) => {
                    this.error('Unhandled promise rejection', {
                        reason: String(event.reason),
                        stack: event.reason && event.reason.stack ? event.reason.stack : 'N/A',
                        error_type: 'UnhandledRejection'
                    });
                });
            }

            log(level, message, metadata = {}) {
                console.log(`[${level}] ${message}`, metadata);

                const logEntry = {
                    level,
                    message,
                    created_at: Date.now() / 1000,
                    service: this.service,
                    environment: this.environment,
                    log_type: this.logType,
                    ...metadata
                };

                fetch('http://localhost:8000/logs', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ logs: [logEntry] })
                }).catch(err => console.error('Log send failed:', err));
            }

            info(msg, meta) { this.log('INFO', msg, meta); }
            warn(msg, meta) { this.log('WARN', msg, meta); }
            error(msg, meta) { this.log('ERROR', msg, meta); }
        }

        // Î°úÍ±∞ Ïù∏Ïä§ÌÑ¥Ïä§ ÏÉùÏÑ± (Í∏ÄÎ°úÎ≤å ÏóêÎü¨ Ìï∏Îì§Îü¨ ÌôúÏÑ±Ìôî)
        const logger = new SimpleLogger({
            enableGlobalErrorHandler: true  // Î™®Îì† ÏóêÎü¨Î•º ÏûêÎèôÏúºÎ°ú Î°úÍπÖ
        });

        // ÏÉÅÌÉú Î©îÏãúÏßÄ ÌëúÏãú
        window.showStatus = function(message) {
            const status = document.getElementById('status');
            status.textContent = message;
            status.classList.add('show');
            setTimeout(() => status.classList.remove('show'), 3000);
        }

        // Î°úÍ∑∏Ïù∏
        document.getElementById('loginForm').addEventListener('submit', async (e) => {
            e.preventDefault();

            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;

            logger.info('Login attempt', { username });

            try {
                const res = await fetch(`${API_URL}/login`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ username, password })
                });

                const data = await res.json();

                if (!res.ok) {
                    throw new Error(data.error);
                }

                currentUser = data.user;
                currentTraceId = data.traceId;

                logger.info('Login successful', { user_id: currentUser.id });

                document.querySelector('.login-form').classList.remove('active');
                document.querySelector('.todo-app').classList.add('active');
                document.getElementById('currentUser').textContent = currentUser.username;

                loadTodos();
                showStatus('Î°úÍ∑∏Ïù∏ ÏÑ±Í≥µ!');

            } catch (err) {
                logger.error('Login failed', { error: err.message });
                document.getElementById('loginError').textContent = err.message;
            }
        });

        // Todo Î°úÎìú
        window.loadTodos = async function() {
            logger.info('Loading todos');

            try {
                const res = await fetch(`${API_URL}/todos`, {
                    headers: {
                        'x-user-id': currentUser.id,
                        'x-trace-id': currentTraceId
                    }
                });

                const data = await res.json();
                const todoList = document.getElementById('todoList');
                todoList.innerHTML = '';

                data.todos.forEach(todo => {
                    const li = document.createElement('li');
                    li.className = `todo-item ${todo.completed ? 'completed' : ''}`;
                    li.innerHTML = `
                        <input type="checkbox" class="todo-checkbox"
                               ${todo.completed ? 'checked' : ''}
                               onchange="toggleTodo('${todo.id}')">
                        <span class="todo-text">${todo.text}</span>
                        <button class="btn-danger btn-small" onclick="deleteTodo('${todo.id}')">ÏÇ≠Ï†ú</button>
                    `;
                    todoList.appendChild(li);
                });

                logger.info('Todos loaded', { count: data.todos.length });

            } catch (err) {
                logger.error('Failed to load todos', { error: err.message });
            }
        }

        // Todo Ï∂îÍ∞Ä
        window.addTodo = async function() {
            const input = document.getElementById('todoInput');
            const text = input.value.trim();

            if (!text) return;

            logger.info('Adding todo', { text });

            try {
                const res = await fetch(`${API_URL}/todos`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'x-user-id': currentUser.id,
                        'x-trace-id': currentTraceId
                    },
                    body: JSON.stringify({ text })
                });

                const data = await res.json();

                logger.info('Todo added', { todo_id: data.todo.id });

                input.value = '';
                loadTodos();
                showStatus('Todo Ï∂îÍ∞ÄÎê®!');

            } catch (err) {
                logger.error('Failed to add todo', { error: err.message });
            }
        }

        // Todo ÏôÑÎ£å ÌÜ†Í∏Ä
        window.toggleTodo = async function(id) {
            logger.info('Toggling todo', { todo_id: id });

            try {
                await fetch(`${API_URL}/todos/${id}`, {
                    method: 'PUT',
                    headers: {
                        'x-user-id': currentUser.id,
                        'x-trace-id': currentTraceId
                    }
                });

                logger.info('Todo toggled', { todo_id: id });

                loadTodos();
                showStatus('Todo ÏóÖÎç∞Ïù¥Ìä∏Îê®!');

            } catch (err) {
                logger.error('Failed to toggle todo', { error: err.message });
            }
        }

        // Todo ÏÇ≠Ï†ú
        window.deleteTodo = async function(id) {
            logger.info('Deleting todo', { todo_id: id });

            try {
                await fetch(`${API_URL}/todos/${id}`, {
                    method: 'DELETE',
                    headers: {
                        'x-user-id': currentUser.id,
                        'x-trace-id': currentTraceId
                    }
                });

                logger.info('Todo deleted', { todo_id: id });

                loadTodos();
                showStatus('Todo ÏÇ≠Ï†úÎê®!');

            } catch (err) {
                logger.error('Failed to delete todo', { error: err.message });
            }
        }

        // ÏóêÎü¨ ÌÖåÏä§Ìä∏
        window.testError = async function() {
            logger.info('Testing error endpoint');

            try {
                const res = await fetch(`${API_URL}/error`, {
                    headers: {
                        'x-user-id': currentUser.id,
                        'x-trace-id': currentTraceId
                    }
                });

                const data = await res.json();
                logger.error('Error response received', { error: data.message });
                showStatus('ÏóêÎü¨ Î∞úÏÉù! Î°úÍ∑∏ ÌôïÏù∏ÌïòÏÑ∏Ïöî.');

            } catch (err) {
                logger.error('Error test failed', { error: err.message });
            }
        }

        // ÎäêÎ¶∞ API ÌÖåÏä§Ìä∏
        window.testSlowApi = async function() {
            logger.info('Testing slow API');
            showStatus('ÎäêÎ¶∞ API Ìò∏Ï∂ú Ï§ë... (2Ï¥à)');

            const startTime = Date.now();

            try {
                await fetch(`${API_URL}/slow`, {
                    headers: {
                        'x-user-id': currentUser.id,
                        'x-trace-id': currentTraceId
                    }
                });

                const duration = Date.now() - startTime;
                logger.info('Slow API completed', { duration_ms: duration });
                showStatus(`ÏôÑÎ£å! (${duration}ms)`);

            } catch (err) {
                logger.error('Slow API test failed', { error: err.message });
            }
        }

        // Î∞∞Ïπò Î°úÍ∑∏ ÌÖåÏä§Ìä∏ - Ïó¨Îü¨ Î°úÍ∑∏Î•º Ìïú Î≤àÏóê Ï†ÑÏÜ°
        window.testBatchLogs = async function() {
            showStatus('Î∞∞Ïπò Î°úÍ∑∏ Ï†ÑÏÜ° Ï§ë...');
            logger.info('Starting batch log test');

            try {
                // 100Í∞úÏùò Î°úÍ∑∏Î•º Îπ†Î•¥Í≤å ÏÉùÏÑ±
                for (let i = 0; i < 100; i++) {
                    logger.info(`Batch log ${i + 1}`, {
                        batch_number: i + 1,
                        test_type: 'batch',
                        user_id: currentUser ? currentUser.id : 'anonymous'
                    });
                }

                logger.info('Batch log test completed', { total_logs: 100 });
                showStatus('100Í∞ú Î°úÍ∑∏ Ï†ÑÏÜ° ÏôÑÎ£å!');

            } catch (err) {
                logger.error('Batch log test failed', { error: err.message });
            }
        }

        // Î∂ÑÏÇ∞ Ï∂îÏ†Å ÌÖåÏä§Ìä∏ - trace_idÎ•º ÌÜµÌïú ÏöîÏ≤≠ Ï∂îÏ†Å
        window.testTracing = async function() {
            showStatus('Î∂ÑÏÇ∞ Ï∂îÏ†Å ÌÖåÏä§Ìä∏ Ï§ë...');
            const traceId = 'trace_' + Date.now();

            logger.info('Starting distributed tracing test', { trace_id: traceId });

            try {
                // Ïó¨Îü¨ APIÎ•º Í∞ôÏùÄ trace_idÎ°ú Ìò∏Ï∂ú
                await fetch(`${API_URL}/todos`, {
                    headers: {
                        'x-user-id': currentUser.id,
                        'x-trace-id': traceId
                    }
                });

                await fetch(`${API_URL}/slow`, {
                    headers: {
                        'x-user-id': currentUser.id,
                        'x-trace-id': traceId
                    }
                });

                logger.info('Distributed tracing test completed', {
                    trace_id: traceId,
                    message: `Check logs with trace_id=${traceId} to see all related requests`
                });
                showStatus(`Ï∂îÏ†Å ÏôÑÎ£å! trace_id: ${traceId.substring(0, 12)}...`);

            } catch (err) {
                logger.error('Tracing test failed', { error: err.message, trace_id: traceId });
            }
        }

        // Î™®Îì† Î°úÍ∑∏ Î†àÎ≤® ÌÖåÏä§Ìä∏
        window.testAllLogLevels = async function() {
            showStatus('Î™®Îì† Î°úÍ∑∏ Î†àÎ≤® ÌÖåÏä§Ìä∏ Ï§ë...');

            try {
                // INFO Î°úÍ∑∏
                logger.info('This is an INFO level log', {
                    test_type: 'log_levels',
                    level_tested: 'INFO'
                });

                // WARN Î°úÍ∑∏
                logger.warn('This is a WARN level log', {
                    test_type: 'log_levels',
                    level_tested: 'WARN',
                    warning_reason: 'Testing warning scenarios'
                });

                // ERROR Î°úÍ∑∏
                logger.error('This is an ERROR level log', {
                    test_type: 'log_levels',
                    level_tested: 'ERROR',
                    error_reason: 'Testing error scenarios'
                });

                logger.info('All log levels tested', {
                    levels: ['INFO', 'WARN', 'ERROR'],
                    total: 3
                });
                showStatus('Î™®Îì† Î°úÍ∑∏ Î†àÎ≤® ÌÖåÏä§Ìä∏ ÏôÑÎ£å!');

            } catch (err) {
                logger.error('Log level test failed', { error: err.message });
            }
        }

        // Î°úÍ∑∏ÏïÑÏõÉ
        window.logout = function() {
            logger.info('Logging out', { user_id: currentUser.id });

            currentUser = null;
            currentTraceId = null;

            document.querySelector('.todo-app').classList.remove('active');
            document.querySelector('.login-form').classList.add('active');

            document.getElementById('username').value = '';
            document.getElementById('password').value = '';
            document.getElementById('loginError').textContent = '';

            showStatus('Î°úÍ∑∏ÏïÑÏõÉÎê®!');
        }

        // Enter ÌÇ§Î°ú Todo Ï∂îÍ∞Ä
        document.getElementById('todoInput').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                addTodo();
            }
        });

        // ============================================================================
        // Ï†ÑÏ≤¥ Í∏∞Îä• ÌÖåÏä§Ìä∏ - Î™®Îì† ÌÅ¥ÎùºÏù¥Ïñ∏Ìä∏ Í∏∞Îä•ÏùÑ ÏàúÏ∞®Ï†ÅÏúºÎ°ú ÌÖåÏä§Ìä∏
        // ============================================================================
        window.runFullTest = async function() {
            logger.info('Starting full test suite');
            showStatus('Ï†ÑÏ≤¥ ÌÖåÏä§Ìä∏ ÏãúÏûë...');

            const results = {
                passed: 0,
                failed: 0,
                tests: []
            };

            const runTest = async (name, testFn) => {
                try {
                    showStatus(`ÌÖåÏä§Ìä∏ Ï§ë: ${name}`);
                    await testFn();
                    results.passed++;
                    results.tests.push({ name, status: 'PASS' });
                    logger.info(`Test passed: ${name}`);
                } catch (err) {
                    results.failed++;
                    results.tests.push({ name, status: 'FAIL', error: err.message });
                    logger.error(`Test failed: ${name}`, { error: err.message, stack: err.stack });
                }
            };

            try {
                // 1. Todo Ï∂îÍ∞Ä ÌÖåÏä§Ìä∏
                await runTest('Todo Ï∂îÍ∞Ä', async () => {
                    const res = await fetch(`${API_URL}/todos`, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'x-user-id': currentUser.id,
                            'x-trace-id': currentTraceId
                        },
                        body: JSON.stringify({ text: 'Test Todo Item' })
                    });
                    if (!res.ok) throw new Error('Failed to create todo');
                    const data = await res.json();
                    window.testTodoId = data.todo.id;
                });

                // 2. Todo Î¶¨Ïä§Ìä∏ Ï°∞Ìöå ÌÖåÏä§Ìä∏
                await runTest('Todo Î¶¨Ïä§Ìä∏ Ï°∞Ìöå', async () => {
                    const res = await fetch(`${API_URL}/todos`, {
                        headers: {
                            'x-user-id': currentUser.id,
                            'x-trace-id': currentTraceId
                        }
                    });
                    if (!res.ok) throw new Error('Failed to fetch todos');
                    const data = await res.json();
                    if (!Array.isArray(data.todos)) throw new Error('Invalid response format');
                });

                // 3. Todo ÏôÑÎ£å ÌÜ†Í∏Ä ÌÖåÏä§Ìä∏
                await runTest('Todo ÏôÑÎ£å ÌÜ†Í∏Ä', async () => {
                    if (!window.testTodoId) throw new Error('No test todo ID available');
                    const res = await fetch(`${API_URL}/todos/${window.testTodoId}`, {
                        method: 'PUT',
                        headers: {
                            'x-user-id': currentUser.id,
                            'x-trace-id': currentTraceId
                        }
                    });
                    if (!res.ok) throw new Error('Failed to toggle todo');
                });

                // 4. Todo ÏÇ≠Ï†ú ÌÖåÏä§Ìä∏
                await runTest('Todo ÏÇ≠Ï†ú', async () => {
                    if (!window.testTodoId) throw new Error('No test todo ID available');
                    const res = await fetch(`${API_URL}/todos/${window.testTodoId}`, {
                        method: 'DELETE',
                        headers: {
                            'x-user-id': currentUser.id,
                            'x-trace-id': currentTraceId
                        }
                    });
                    if (!res.ok) throw new Error('Failed to delete todo');
                });

                // 5. ÏóêÎü¨ ÏóîÎìúÌè¨Ïù∏Ìä∏ ÌÖåÏä§Ìä∏
                await runTest('ÏóêÎü¨ Ï≤òÎ¶¨', async () => {
                    const res = await fetch(`${API_URL}/error`, {
                        headers: {
                            'x-user-id': currentUser.id,
                            'x-trace-id': currentTraceId
                        }
                    });
                    // ÏóêÎü¨ ÏóîÎìúÌè¨Ïù∏Ìä∏Îäî 500ÏùÑ Î∞òÌôòÌï¥Ïïº Ìï®
                    if (res.status !== 500) throw new Error('Error endpoint should return 500');
                });

                // 6. ÎäêÎ¶∞ API ÌÖåÏä§Ìä∏
                await runTest('ÎäêÎ¶∞ API (ÌÉÄÏù¥Î®∏)', async () => {
                    const startTime = Date.now();
                    const res = await fetch(`${API_URL}/slow`, {
                        headers: {
                            'x-user-id': currentUser.id,
                            'x-trace-id': currentTraceId
                        }
                    });
                    if (!res.ok) throw new Error('Slow API failed');
                    const duration = Date.now() - startTime;
                    if (duration < 1500) throw new Error('API returned too quickly');
                });

                // UI ÏÉàÎ°úÍ≥†Ïπ®
                await loadTodos();

                // Í≤∞Í≥º ÌëúÏãú
                const summary = `ÌÖåÏä§Ìä∏ ÏôÑÎ£å! ÌÜµÍ≥º: ${results.passed}, Ïã§Ìå®: ${results.failed}`;
                showStatus(summary);
                logger.info('Full test completed', {
                    total: results.tests.length,
                    passed: results.passed,
                    failed: results.failed,
                    details: results.tests
                });

                // ÏΩòÏÜîÏóê ÏÉÅÏÑ∏ Í≤∞Í≥º Ï∂úÎ†•
                console.log('='.repeat(50));
                console.log('Ï†ÑÏ≤¥ ÌÖåÏä§Ìä∏ Í≤∞Í≥º:');
                results.tests.forEach(test => {
                    const icon = test.status === 'PASS' ? '‚úÖ' : '‚ùå';
                    console.log(`${icon} ${test.name}: ${test.status}${test.error ? ` (${test.error})` : ''}`);
                });
                console.log('='.repeat(50));

            } catch (err) {
                logger.error('Full test suite failed', { error: err.message, stack: err.stack });
                showStatus('ÌÖåÏä§Ìä∏ Ï§ë Ïò§Î•ò Î∞úÏÉù!');
            }
        }

        // Enter ÌÇ§Î°ú Todo Ï∂îÍ∞Ä
        document.getElementById('todoInput').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                addTodo();
            }
        });
    </script>
</body>
</html>
